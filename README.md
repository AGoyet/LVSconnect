# LVSconnect
This project aims to automate some tasks when using the "La Vie Scolaire" websites made by AXESS. The project is not affiliated to AXESS.

A valid username and password for one such website is necessary.

## Installation

You will need to have Python 3 install with the packages in requirements.txt installed. This can be done in a console with:
```
python -m pip install --upgrade pip
python -m pip install -r requirements.txt
```

## Usage

All programs have command line options (launch any with "-h" to see those options), but all can be run without any options,
and will ask interactively for any needed parameter.

### lvs_attendance

This program will show all student absences for a given test, with the motive registered by the school administration.
This is slightly better than using the calendar view for attendance on the website, as it checks for a "group" of students 
instead of a "class". Groups can mix students from multiple classes, and tests are given to a group, not a class. On top of
that the program filters out the students who have a numeric non zero grade for the test. Alternatively, the user can choose
to check the attendance for a whole group for a given date, irrespective of tests (this is useful for a test which is not
uploaded to the website yet).

### lvs_send_grades

This program does the reverse of the "export" function on the website. The user should first use that function to get a .csv
(the export option is hidden in a "three dots" menu button in the appreciation tab of the evaluation section). The user can
then modify this .csv file in a spreadsheet, save it, then run the program (which will ask for the file). The program will 
then upload all new grades an tests, as well as any modified test parameters (max grade and coefficient). If the upload
would result in any deletion or overwriting of grades, the program will give a warning (with the name of affected students)
and ask for confirmation.

The format of the .csv file (as generated by the website) includes test names are on the first line, with the cell below each
name describing the maximum grade and coefficient, such as "/10 - Coef : 0.5".

#### Limitations

Each test present on the website has a creation date and a "published" flag (on by default). Since those are not visible in 
the exported .csv file, the program cannot guess them accurately (the current date is used when creating tests). The user will
thus need to use the website to set those correctly, for example when uploading multiple tests at once.

## Configuration file

By default, all programs look for a config file in the platform appropriate locations, using module 
[appdir](https://pypi.org/project/appdirs/)
and also in the executable's folder. This is a json file named `LVSconnect_config.json`. It can contain any of the 
command-line parameters, for example the "user" parameters to save time at login.
The values from the config file are overridden by values passed in the command line.

A specific case is the base-url parameter. If this is not provided, the program will ask interactively for the url, then
create a configuration file to save it for future use.

## Distribution / customization

To distribute this program to teachers in your high-school, you might want to add your own `LVSconnect_config.json` file with your
own school's base url as explained in the "configuration file" section. This can be done easily by simply including the file 
generated on first launch.

To distribute it as a windows executable, the provided pyinstaller scripts can be used (the .bat script can be run on Linux with `bash -c pyinstaller_script.bat`). This generates a "dist" folder with one .exe file for each program.

## FAQ

#### If this is all for a french website, why is this program speaking English to me?
Because English is the lingua franca of the internet and programming. This would allow part of the code (including dialogs)
to be reused in other projects not aimed at a french audience. A localization PR would of course be welcome.

#### Why is this program sometimes speaking French to me?
Some of the text comes directly from the website and is thus possibly in French.

#### Does the program store my password?
No. The password stays in memory only. This is also true for the user name. You can add your password to the configuration 
json file to save time, but this is not recommended and not done automatically. 
